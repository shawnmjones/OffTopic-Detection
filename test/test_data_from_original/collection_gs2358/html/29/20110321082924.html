<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>HyperCities Egypt</title>
    <!--
      	Google font
    -->
    <link href='http://fonts.googleapis.com/css?family=Ubuntu|Philosopher' rel='stylesheet' type='text/css' />

	<!--
    	Google Map
    -->
    <script src="http://maps.google.com/maps?file=api&amp;v=2&amp;sensor=false&amp;key=ABQIAAAAtHf2Vbojx_f9l2digk62nRSSl0hUSkxowoQw3Cy7Qa8kWB_4ZBSG_jhwvWJf0IIL8EcKTHA4kHGmdw" type="text/javascript"></script>
	
    <!--
      	jQuery
    -->    
	<script src="js/jquery-1.4.2.min.js" type="text/javascript"></script>
	<script src="js/jquery.timeago.js" type="text/javascript"></script>
	<script src="js/centerIt.js" type="text/javascript"></script>
        
	<script type="text/javascript" src="js/jquery-ui-1.8.9.custom.min.js"></script>
	<!--script type="text/javascript" src="scripts/jquery-ui-1.8.9.custom.min.js"></script-->
	<script>
	$(function() {
		$( "#radio" ).buttonset();
	});
	</script>
    <!--
      	jCarousel library
    -->
    <script type="text/javascript" src="js/jcarousel.js"></script>
    <script type="text/javascript" src="js/jquery.jcarousel.js"></script>

    <!--
      jCarousel skin stylesheet
    -->
    <link rel="stylesheet" type="text/css" href="css/skin.css" />
    <link rel="stylesheet" type="text/css" href="css/ui-lightness/jquery-ui-1.8.9.custom.css" />
    <link rel="stylesheet" type="text/css" href="css/jquery.datepicker.css" />

	<script type="text/javascript" src="./scripts/date.js"> </script>
	<!-- Application-specific scripts -->
	<script type="text/javascript" src="scripts/HyperCitiesNow.js"></script>
	<script type="text/javascript" src="scripts/backInTimeList.js"></script>
	<script type="text/javascript" src="scripts/search.js"></script>
	<script type="text/javascript" src="scripts/jquery.betterdatetimepicker.js"></script>


	<script type="text/javascript">
		jQuery(document).ready(function() {});
    </script>
    
	<style type="text/css">
		v\:* {behavior:url(#default#VML);}
		html, body {width: 100%; height: 100%}
		body {
			margin-top: 0px; 
			margin-right: 0px; 
			margin-left: 0px; 
			margin-bottom: 0px;
			font-size:12px;
			font-family:'Ubuntu','Palatino Linotype', 'Book Antiqua', Palatino, serif;
			}
		h1 {
			font-family:'Ubuntu','Palatino Linotype', 'Book Antiqua', Palatino, serif;
			font-size:24px;
		}
		h3 {
			color:#CCC; 
			font-family:'Ubuntu','Palatino Linotype', 'Book Antiqua', Palatino, serif;
			font-size:14px;
			font-weight: normal;
		}
		h4 {
			color:#333; 
			font-family:'Ubuntu','Palatino Linotype', 'Book Antiqua', Palatino, serif;
			font-size:14px;
			margin:0px;
			padding:0px;
		}
		p {
			font-family:'Ubuntu','Palatino Linotype', 'Book Antiqua', Palatino, serif;
			font-size:12px;
			color:#999;
		}
		a:link {text-decoration:none}
		a:hover {text-decoration:underline}
			
	 #quote {
		font-family:'Ubuntu','Palatino Linotype', 'Book Antiqua', Palatino, serif;
		 font-size:18px;
		 font-weight:500;
		 line-height:25px;
		 /*text-shadow: 2px 2px 2px #aaa;*/
	 }
	 #datedisplay {
		font-family:'Ubuntu','Palatino Linotype', 'Book Antiqua', Palatino, serif;
		 color:gainsboro;
		 background-color:#666; 
		 padding:4px; 
		 font-size:12px;
		 padding:2px 10px;
		 margin:4px;
		 padding-left:10px;
		 text-align:center;
		 
	 }
	 #submitDateSearch {
			position:absolute;
			padding: 1px 2px;
		}
	 #timedisplay {
		 
	 }
		.rounded-corners {
			-moz-border-radius: 10px;
			-webkit-border-radius: 10px;
			-khtml-border-radius: 10px;
			border-radius: 10px;
		}
		.rounded-corners-time {
			-moz-border-radius: 5px;
			-webkit-border-radius: 5px;
			-khtml-border-radius: 5px;
			border-radius: 5px;
			 color:gainsboro;
			 background-color:#333; 
			 padding:4px; 
			 font-size:12px;
			 padding:2px 10px;
			 margin:4px;
			 padding-left:10px;
			 text-align:center;
			 cursor:pointer;
		}
		.rounded-corners-date {
			-moz-border-radius: 5px;
			-webkit-border-radius: 5px;
			-khtml-border-radius: 5px;
			border-radius: 5px;
			 color:gainsboro;
			 background-color:#666; 
			 padding:4px; 
			 font-size:12px;
			 padding:2px 10px;
			 margin:4px;
			 padding-left:10px;
			 text-align:center;
			 cursor:pointer;
		}
		.time {
			color: #3373a3;
			font-family:'Ubuntu','Palatino Linotype', 'Book Antiqua', Palatino, serif;
			font-size:12px;
		}

		.timeListRoot {
			display: none;
		}
		.darklink
		{
			color:#9C0;
		}

	</style>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-21238087-1']);
  _gaq.push(['_trackPageview']);

  function autolink (s) {
	  console.log("Autolink called.");
	console.log(s);
	   var hlink = /\s(ht|f)tp:\/\/([^ \,\;\:\!\)\(\"\'\<\>\f\n\r\t\v])+/g;
	   return (s.replace (hlink, function ($0,$1,$2) { s = $0.substring(1,$0.length);
													   // remove trailing dots, if any
													   while (s.length>0 && s.charAt(s.length-1)=='.')
														  s=s.substring(0,s.length-1);
													   // add hlink
													   return " " + s.link(s);
													 }
						 )
			   );
	}

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</head>

<body onload="init()"> 
<!--- ===================================================================================================================
*
*	Div Layouts
*
===================================================================================================================== --->
    <div id="tweetbox" class="rounded-corners">
        <div id="startstop" style="position:relative; top: -5px; left:10px;">
        	<a href="javascript:togglestartstop();"><img id="startstopimage" src="images/pause.png" width="20" align="absmiddle" border="0"/></a>
        	<a href="javascript:togglestartstop();" id="startstopvalue">pause</a>
        </div>

        <form>
            <div id="radio" style="position:relative;right:-150px; top:-20px;">
                <input type="radio" id="radio1" name="radio" checked="checked" onclick="changespeed(5000)" /><label for="radio1" style="padding:2px 10px; font-size:11px"> slow </label>
                <input type="radio" id="radio2" name="radio" onclick="changespeed(1500)" /><label for="radio2" style="padding:2px 10px; font-size:11px"> fast </label>
            </div>
        </form>

        <div id="tweetboxcontent"></div>
    </div>

    <div id="mycarousel" class="jcarousel-skin-tango" style="top:10px; z-index:10; opacity:0.9; filter: alpha(opacity=90);margin:0 auto; padding:0px">
        <ul></ul>
    </div>
    
    <div id="map" style="width: 100%; height: 100%; color: Black;overflow:hidden;"></div>
    
    <div align="left" class="rounded-corners" style="position:absolute; top:50px; left:80px; border:4px solid black; background:black; color:white; padding:10px 10px; padding-top: 0px;width:230px;opacity: 0.9;filter: alpha(opacity=90);">
    
        <h1>HyperCities Egypt</h1>
        <img src="images/twitter.png" style="float:left; padding-right:10px;" width="40" />
        <h3 >Voices from Cairo through social media</h3>
        
        <div class="rounded-corners-s" style="padding:10px;background-color:#222; max-height:350px; overflow:auto;">
        	<span id="backintime" onclick="$('#datechooser').slideToggle('slow');"><span style="top:-7px; position:relative; cursor:pointer;">
        	Go back in time&nbsp;&nbsp;<img src="images/time.png" width="25" style="position:relative; top:7px;" /></span></span>
            <div style="color:gainsboro; display:none;" id="datechooser">
            	<div id="dateSearchWrapper">
				<select id="dateSearchDay"></select>
				<select id="dateSearchTime"></select>
        		<button id="submitDateSearch">Go</button>
        	</div>
                or...
				<br />
                <div class="rounded-corners-time" id="showLiveTweets" style="color:gainsboro;">Show live tweets</div>
            </div>
            
        </div>
        
    <script>
	$(".rounded-corners-date").hover(
	  function () {
		$(this).css('cursor','pointer');
		$(this).css('background-color','gray');
	  },
	  function () {
		$(this).css('background-color','#666');
	  }
	  
	);
	$(".rounded-corners-time").hover(
	  function () {
		$(this).css('cursor','pointer');
		$(this).css('background-color','#444');
	  },
	  function () {
		$(this).css('background-color','#333');
	  }
	  
	);
	</script>

        

		<!--
		 <span id="carouselnext" onclick="jQuery('#mycarousel').jcarousel('next');">next</span>
		 <span onclick="jQuery('#mycarousel').jcarousel('reset');">reset</span>
		 <a href="javascript:void(0)" onclick="jQuery('#mycarousel').jcarousel({next: 10 });">next 10</a>
		-->
        <p>
       <!-- This project is in <span style="color:red;">BETA</span>.  Last updated February 3, 2011<br />-->
	   <div class="rounded-corners-s" style="padding:10px;background-color:#222; max-height:350px; overflow:auto;">
		   <div id="textSearch" style=" cursor:pointer;top:-7px; position:relative;">Search tweets&nbsp;&nbsp;&nbsp;&nbsp;<img src="images/search.png" width="22" style="position:relative; top:6px;"/></div>
		   <div id="textSearchWrapper" style="display:none">
			   <p id="searchMessage">Enter text to search tweets for:</p>
			   <form id="searchForm">
				   <fieldset style="border:none;">
					   <input type="text" id="textSearchBox"></input>
					   <!--input type="submit" name="search" value="Search" id="textSearchButton"></input-->
				   </fieldset>
				</form>
		   </div>
	   </div>
        <div style="padding-left:-5px; position:relative"><p ><img src="images/ucla_swb36.gif" />
        <span style="top:-6px; position:relative">A Digital Humanities Project <a href="javascript:void(0)" onclick="$('#about').CenterIt();"><img src="images/about.png" width="18" border="0" alt="about" style="position:relative; top:3px;" /></a></span><br />

    <!-- About -->
	<div id="about" class="rounded-corners" style="display:none; width:300px;  background-color:black; padding:20px 40px;" onclick="$(this).fadeOut();">
        <div style="float:right">
        <img src="images/close.png" onmouseover="$(this).css('cursor','pointer')" />
        </div>
    	<h1>About</h1>
        <p>
        This website was created by 3 technology enthusiasts from the <a href="http://www.digitalhumanities.ucla.edu" class="darklink" target="_blank">UCLA Digital Humanities collaborative</a>.
        </p>
        <p>
        <strong>Todd Presner</strong> is the Director of the <a href="http://www.hypercities.com" class="darklink" target="_blank">Hypercities Project</a>, and faculty sponsor of this initiative.
        <p>
        <strong>Yoh Kawano</strong> is UCLA's Campus GIS Coordinator and a lecturer in the School of Public Affairs who relishes in seeing all things spatially.
        </p>
        <p>
        <strong>David Shepard</strong> is the HyperCities tech team lead, and a sixth-year Graduate Student in the Department of English, who likes making maps of books.
        </p>
    </div>


    </div>

<!--- ===================================================================================================================
*
*	Maproom Javascript
*
===================================================================================================================== --->
<script type="text/javascript">
    //<![CDATA[
	
	var avatars = [];
	var markers = [];
	var titles = [];
	var points = [];
	var addresses = [];
	var timestamps = [];
	var usernames = [];
	var tweetid = [];
	var map;
	var feedlat = '30.062259991480175';
	var feedlng = '31.249509';
	var geocoder = new GClientGeocoder();
	var feedcount = 200;
	var feedinterval = 5000;
	var tweetquery = '%23jan25'; // add a search variable to the tweets
	var tweeturl = 'http://search.twitter.com/search.json?geocode=30.062259991480175,31.253700256347656,25mi&since=2011-01-30&rpp='+feedcount+'&q='+tweetquery;
	var tweeturl = 'http://search.twitter.com/search.json?geocode=30.062259991480175,31.253700256347656,200mi&rpp=100&q=%23jan25+OR+%23Egypt+OR+%23tahrir';

	function changespeed(interval)
	{
		feedinterval = interval;
	}

	/*
	
		For Debuggin
		
	*/
	
	function dump(arr,level) {
		var dumped_text = "";
		if(!level) level = 0;
		
		//The padding given at the beginning of the line.
		var level_padding = "";
		for(var j=0;j<level+1;j++) level_padding += "    ";
		
		if(typeof(arr) == 'object') { //Array/Hashes/Objects 
			for(var item in arr) {
				var value = arr[item];
				
				if(typeof(value) == 'object') { //If it is an array,
					dumped_text += level_padding + "'" + item + "' ...\n";
					dumped_text += dump(value,level+1);
				} else {
					dumped_text += level_padding + "'" + item + "' => \"" + value + "\"\n";
				}
			}
		} else { //Stings/Chars/Numbers etc.
			dumped_text = "===>"+arr+"<===("+typeof(arr)+")";
		}
		return dumped_text;
	}



	// A function to create the marker and set up the event window
	function createMarker(point,name,icon) 
	{
		var thisIcon = new GIcon(G_DEFAULT_ICON,icon);
		thisIcon.iconSize = new GSize(30,30);
		thisIcon.shadow = null;
		thisIcon.shadowSize = new GSize(30,20);
		thisIcon.iconAnchor = new GPoint(20,20);
		var marker = new GMarker(point, thisIcon);
		GEvent.addListener(marker, "click", function() {
		marker.openInfoWindowHtml(name);
		});
		return marker;
	}

	function clickmarker(i) {
		//fadeo('tweetboxcontent');
		//$('#tweetboxcontent').fadeOut('slow',fadei('tweetboxcontent'));
		fadei('tweetboxcontent');
		map.panTo(points[i]);
		document.getElementById('tweetboxcontent').innerHTML = titles[i];	  
	}

	function togglestartstop(i) {
		if (document.getElementById('startstopvalue').innerHTML == 'pause')
		{
			
			document.getElementById('startstop').innerHTML = '<a href="javascript:togglestartstop();"><img id="startstopimage" src="images/pause.png" width="20" align="absmiddle" border="0" /></a> <a id="startstopvalue" href="javascript:togglestartstop('+(i+1)+');">start</a>';
		}
		else
		{
			document.getElementById('startstop').innerHTML = '<a href="javascript:togglestartstop();"><img id="startstopimage" src="images/pause.png" width="20" align="absmiddle" border="0" /></a> <a id="startstopvalue" href="javascript:togglestartstop('+i+');">pause</a>';
			addandpan(i, false);
		}
	}
	function togglestop(i) {
			document.getElementById('startstop').innerHTML = '<a href="javascript:togglestartstop();"><img id="startstopimage" src="images/pause.png" width="20" align="absmiddle" border="0" /></a> <a id="startstopvalue" href="javascript:togglestartstop('+(i+1)+');">start</a>';
	}
	function fadeo(divelementid) {
		$('#'+divelementid).fadeOut('slow');
	}
	function fadei(divelementid) {
		$('#'+divelementid).fadeIn('slow');
	}
	
	function trim(stringToTrim) 
	{
		return stringToTrim.replace(/^\s+|\s+$/g,"");
	}
	
	var timeOutId = [];    // Array to store all setTimeout Id
	var timeOutCount = 0;  // Counter of number of existed timeout instance
	
	function addandpan(i, restart) {
		if (document.getElementById('startstopvalue').innerHTML == 'pause')
		{
			fadeo('tweetboxcontent');
			if (restart) 
			{
				trace("restart");
				while(timeOutCount--) 
				{
					clearTimeout(timeOutId.pop());	
				}
				
				// Clear jcarousel right before we start to rendering new tweets
				jQuery('#mycarousel').jcarousel('reset');
				//jQuery('#mycarousel').jcarousel({scroll: 1 });	
			}
			trace("append cell " + i);			
			timeOutId.push(setTimeout("addandpan2("+i+")",500));
			timeOutCount++;
			
			document.getElementById('startstop').innerHTML = '<a href="javascript:togglestartstop();"><img id="startstopimage" src="images/pause.png" width="20" align="absmiddle" border="0" /></a> <a id="startstopvalue" href="javascript:togglestartstop('+i+');">pause</a>';		
		}
	}
	

	
	function addandpan2(i) 
	{
			//alert(addresses.length);
			if (i < addresses.length)
			{
				trace("append tweet id " + tweetid[i]);
				fadei('tweetboxcontent');
				var thiselement = 't' + (i+1);
				document.getElementById('tweetboxcontent').innerHTML = titles[i];
				var carouselcontent = '<a href="javascript:void(0)" onclick="togglestop('+i+');clickmarker('+i+')"><img src=' + avatars[i] + ' width=24 border=0 title="'+ timestamps[i] + '"></a>';
				jQuery('#mycarousel').jcarousel('add', i, carouselcontent);
				trace("carousel added at " + i);
				
				// move carousel
				if (i > 30)
				{
					jQuery('#mycarousel').jcarousel('next');
				}
				nexti = i + 1;
				timeOutId.push(setTimeout("addandpan(nexti, false);",feedinterval));
				timeOutCount++;
				
				// if it has geo coordinates
				if (addresses[i].search(":") > 0)
				{
					var thislatlon = addresses[i].split(':');
					thislatlon = thislatlon[1].split(',');
					var point = new GLatLng(trim(thislatlon[0]),trim(thislatlon[1]));
					var thismarker = createMarker(point,titles[i],avatars[i]);
					map.panTo(point);
					map.addOverlay(thismarker);
					markers.push(thismarker);
					points[i]=point;
				}
				// if not, then geocode
				else
				{
					geocoder.getLatLng(addresses[i], function(point) 
					{
						if (!point) 
						{
						} 
						else 
						{
							var thismarker = createMarker(point,titles[i],avatars[i]);
							map.panTo(point);
							map.addOverlay(thismarker);
							markers.push(thismarker);
							points[i]=point;
						 }
					});
				}
			}
			else
			{
				//getJSON(tweeturl);
			}
  	}

	function getJSON(t,restart)
	{

	  return;
	  // Retrieve the JSON feed.
	  var script = document.createElement('script');
	  script.setAttribute('src', t+'&callback=cm_loadMapJSON');
	  script.setAttribute('id', 'jsonScript');
	  script.setAttribute('type', 'text/javascript');
	  document.documentElement.firstChild.appendChild(script);
	  if (restart==1)
	  {
		  setTimeout("addandpan(0)",1000);
	  }
	}


	function trace(message) 
	{ 
		if (typeof console != 'undefined') 
		{
			//console.log(message);
		}
	}
	
	function getJSON2()
	{
		//clear existing data
		timestamps.length=0;
		addresses.length=0;
		avatars.length=0;
		titles.length=0;
		usernames.length=0;
		
		jsonurl = "http://egypt.hypercities.com/last_tweets.php?number=100";
		$.getJSON(jsonurl, function(data) {
			//trace(dump(data));
			
			for (var i=0, c=data.result.length; i<c; i++) {
				trace(dump(data.result[i]));

				tweetid[i] = data.result[i].id;
				timestamps[i]=data.result[i].time;
				usernames[i]=data.result[i].username;
				addresses[i]=data.result[i].location;
				avatars[i] = data.result[i].profile_image_url;
				var info4tweetbox = '<div style="width:100%; text-align:left;"><table cellpadding=8 border=0><tr><td valign=top align=left width=50><img src="' + avatars[i] + '" width=48><i></td><td valign="top"><h4>' + usernames[i] + '</h4><br>' + addresses[i] + '<br></td></tr><td colspan=2 valign=top><div id="quote">' +  autolink(data.result[i].text)+'</div><span class="time">' + jQuery.timeago(timestamps[i]) + '</span></td></tr></table></div>';
				titles[i] = info4tweetbox;
			}
			setTimeout("addandpan(0, true)",1000); // This should be in AJAX success callback.
		});
	}

	function getJSON2bytime(starttime)
	{
		//clear existing data
		timestamps.length=0;
		addresses.length=0;
		avatars.length=0;
		titles.length=0;
		usernames.length=0;
		
		jsonurl = "http://egypt.hypercities.com/tweet_query.php?start="+starttime;
		$.getJSON(jsonurl, function(data) {
			//trace(dump(data.result));
			//alert(data.result);
			if (data.result == undefined)
			{
				alert('No tweets found for that time period');
			}
			else
			{
				for (var i=0, c=data.result.length; i<c; i++) {
					trace(dump(data.result[i]));
	
					tweetid[i] = data.result[i].id;
					timestamps[i]=data.result[i].time;
					usernames[i]=data.result[i].username;
					addresses[i]=data.result[i].location;
					avatars[i] = data.result[i].profile_image_url;
					
					if (avatars[i] == null)
					{
						avatars[i] = "images/avatar.gif";
					}
					var info4tweetbox = '<div style="width:100%; text-align:left;"><table cellpadding=8 border=0><tr><td valign=top align=left width=50><img src="' + avatars[i] + '" width=48><i></td><td valign="top"><h4>' + usernames[i] + '</h4><br>' + addresses[i] + '<br></td></tr><td colspan=2 valign=top><div id="quote">' + autolink(data.result[i].text)+'</div><span class="time">' + jQuery.timeago(timestamps[i]) + '</span></td></tr></table></div>';
					titles[i] = info4tweetbox;
				}			
				setTimeout("addandpan(0, true)",1000); // This should be in AJAX success callback.
			}
		});
	}

		
	/** 
	 * Called when JSON is loaded. Creates sidebar if param_sideBar is true.
	 * Sorts rows if param_rankColumn is valid column. Iterates through worksheet rows, 
	 * creating marker and sidebar entries for each row.
	 * @param {JSON} json Worksheet feed
	 */       
	function cm_loadMapJSON(json) 
	{
		json.results.reverse();
		for (var i = 0; i < json.results.length; i++) 
		{
			var entry = json.results[i];
			timestamps[i]=entry.created_at;
			addresses[i]=entry.location;
			avatars[i] = entry.profile_image_url;
			var info4tweetbox = '<div style="width:100%; text-align:left;"><table cellpadding=8 border=0><tr><td valign=top align=left width=50><img src="' + avatars[i] 
				+ '" width=48><i></td><td>' + addresses[i] + '<br></td></tr><td colspan=2 valign=top><div id="quote">' 
				+ entry.text+'</div><span class="time">' 
				//+ jQuery.timeago(timestamps[i]) 
				+ Date.parse(timestamps[i]).toString("MMMM d, yyyy hh:mm:ss tt")
				+ '</span></td></tr></table></div>';
			titles[i] = info4tweetbox;
		}
	}
	function newfeed(feedlat,feedlng)
	{
		if (feedlat == undefined)
		{
			feedlat = map.getCenter().lat();
			feedlng = map.getCenter().lng();
		}
		getJSON('http://search.twitter.com/search.json?geocode='+feedlat+','+feedlng+',25mi&rpp='+feedcount+'&q='+ document.getElementById("tweetquery").value,1);
	}
	
	function init()
	{
		if (GBrowserIsCompatible()) {
		// create the map
		map = new GMap2(document.getElementById("map"));
		map.setMapType(G_HYBRID_MAP);
		map.setCenter(new GLatLng(feedlat,feedlng),15);
		
		var mapTypeControl = new GHierarchicalMapTypeControl();
		var mapControl = new GLargeMapControl3D();
		//var minimap = new GOverviewMapControl();
		
		var topRight = new GControlPosition(G_ANCHOR_TOP_RIGHT, new GSize(300,50));
		var topLeft = new GControlPosition(G_ANCHOR_TOP_LEFT, new GSize(10,50));
		
		
		map.addControl(mapTypeControl, topRight);
		map.addControl(mapControl, topLeft);
		//map.addControl(minimap);
			
		
		
		//map.setUIToDefault();
		var bounds = new GLatLngBounds();
		//setTimeout("addandpan(0)",2000);
		//getJSON(tweeturl);
		//getJSON2();
		HyperCitiesNow.init();
		HyperCitiesNow.viewLiveFeed();
		
		GEvent.addListener(map, "dragend", function() {
			  newfeed(map.getCenter().lat(),map.getCenter().lng());
			 });	
		// Monitor the window resize event and let the map know when it occurs
		if (window.attachEvent) 
		{ 
			window.attachEvent("onresize", function() {this.map.onResize()} );
		} 
		else 
		{
			window.addEventListener("resize", function() {this.map.onResize()} , false);
		}
		
	}

    else {
      alert("Sorry, the Google Maps API is not compatible with this browser");
    }
}

    //]]>
    </script>

  </body>

</html>